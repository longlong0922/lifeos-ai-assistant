# 📊 如何查看用户数据

## 🚀 快速开始

### 方式一：交互式模式（推荐）

```powershell
python scripts\view_user_data.py
```

会出现一个菜单，让你选择：
1. 查看所有用户列表
2. 查看指定用户详情
3. 比较多个用户数据
0. 退出

### 方式二：命令行模式

#### 列出所有用户
```powershell
python scripts\view_user_data.py list
```

#### 查看指定用户详情
```powershell
python scripts\view_user_data.py view <用户ID>
```

例如：
```powershell
python scripts\view_user_data.py view 1
```

#### 比较多个用户
```powershell
python scripts\view_user_data.py compare <ID1> <ID2> <ID3>
```

例如：
```powershell
python scripts\view_user_data.py compare 1 2 3
```

---

## 📋 显示的数据包括

### 用户基本信息
- 用户名
- 用户ID
- 创建时间
- 时区设置
- 偏好设置

### 数据统计
- 📊 习惯数量
- 🎯 目标数量
- 💭 反思数量
- 🔮 决策数量
- 💬 聊天记录数

### 详细数据

#### 🏃 习惯列表
每个习惯显示：
- 习惯名称和状态（活跃/已停用）
- 描述和频率
- 创建时间
- 打卡次数
- 最近3次打卡记录

#### 🎯 目标列表
每个目标显示：
- 目标标题和状态
- 描述
- 完成进度
- 截止时间
- 里程碑（前3个）

#### 💭 反思记录
最近5条反思显示：
- 反思日期
- 对话内容摘要
- AI 洞察

#### 🔮 决策记录
最近5条决策显示：
- 决策时间
- 问题描述
- 考虑的因素
- 用户选择
- 结果反馈

#### 💬 聊天记录
最近10条聊天显示：
- 时间戳
- 用户/AI 对话
- 会话分组

---

## 💡 使用场景

### 场景1：检查数据是否加载成功
```powershell
python scripts\view_user_data.py list
```
如果显示用户，说明数据库正常。

### 场景2：调试某个用户的问题
```powershell
python scripts\view_user_data.py view 1
```
可以看到该用户的所有数据，方便排查问题。

### 场景3：了解系统使用情况
```powershell
python scripts\view_user_data.py list
```
查看所有用户的统计，了解整体使用情况。

### 场景4：比较不同用户的数据
```powershell
python scripts\view_user_data.py compare 1 2 3
```
可以并排比较多个用户的数据量。

---

## 🎨 输出示例

### 用户列表示例
```
======================================================================
  👥 所有用户列表
======================================================================

共找到 3 个用户：

  [1] demo_user
      创建时间: 2025-11-10 08:47:19
      时区: Asia/Shanghai
      数据统计: 4个习惯, 1个目标, 3条反思, 5个决策

  [2] test_user
      创建时间: 2025-11-11 10:00:00
      时区: Asia/Shanghai
      数据统计: 2个习惯, 0个目标, 0条反思, 0个决策

  [3] alice
      创建时间: 2025-11-11 12:00:00
      时区: Asia/Shanghai
      数据统计: 6个习惯, 3个目标, 12条反思, 8个决策
```

### 用户详情示例
```
======================================================================
  👤 用户详情: demo_user (ID: 1)
======================================================================

基本信息:
  用户名: demo_user
  用户ID: 1
  创建时间: 2025-11-10 08:47:19
  时区: Asia/Shanghai

数据统计:
  📊 习惯数量: 4
  🎯 目标数量: 1
  💭 反思数量: 3
  🔮 决策数量: 5
  💬 聊天记录: 72

──────────────────────────────────────────────────────────────────────
  🏃 习惯列表
──────────────────────────────────────────────────────────────────────

  [2] 每天跑步30分钟 (✅ 活跃)
      描述: 保持健康，提升精力
      频率: daily
      创建时间: 2025-11-10 08:47:19
      打卡次数: 3
      最近打卡:
        ✅ 2025-11-10 00:00:00
           天气很好，下午没有会议，状态不错
        ❌ 2025-11-09 00:00:00
           加班到晚上9点，太累了
```

### 用户对比示例
```
======================================================================
  📊 用户数据对比 (共3个用户)
======================================================================

用户ID     用户名           习惯     目标     反思     决策     聊天    
──────────────────────────────────────────────────────────────────────
1          demo_user        4        1        3        5        72      
2          test_user        2        0        0        0        12      
3          alice            6        3        12       8        156     
```

---

## 🔧 技术细节

### 数据来源
- 数据来自 `data/lifeos.db` SQLite 数据库
- 使用只读模式查询，不会修改数据

### 性能优化
- 使用 JOIN 查询减少数据库访问
- 限制显示数量（最近N条）
- 长文本自动截断

### 错误处理
- 用户不存在时友好提示
- 数据格式异常时跳过显示
- JSON 解析失败时显示原始数据

---

## 💡 提示

1. **数据太多？** 工具会自动限制显示数量，只显示最近的记录

2. **想看完整聊天？** 可以直接查看数据库或使用 API

3. **想导出数据？** 可以重定向输出到文件：
   ```powershell
   python scripts\view_user_data.py view 1 > user_1_data.txt
   ```

4. **想修改数据？** 这个工具只是查看，修改请使用其他工具或 API

---

## 🆘 常见问题

### Q: 显示"数据库中没有用户"？
A: 需要先加载示例数据：
```powershell
python scripts\load_sample_data.py
```

### Q: 用户ID怎么知道？
A: 先运行 `list` 命令查看所有用户和ID

### Q: 可以删除用户吗？
A: 这个工具只是查看，不提供删除功能。如需删除，请直接操作数据库。

### Q: 数据显示不全？
A: 工具会自动截断长文本。如需完整数据，请查看数据库或使用 API。

---

## 🎯 下一步

查看用户数据后，你可以：
- 使用 `python scripts\chat.py` 进行对话测试
- 使用 `python run.py` 启动 Web 界面
- 使用 `python start.py` 打开管理菜单
- 查看 API 文档了解更多功能

祝使用愉快！ 🚀
